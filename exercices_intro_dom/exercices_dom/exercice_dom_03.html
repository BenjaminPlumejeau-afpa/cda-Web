<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exercice : Création et suppression d'éléments</title>
    <script type="module">
        const listeTaches = document.getElementById('liste-taches');
        const inputNouvelleTache = document.getElementById('nouvelle-tache');
        const boutonAjouter = document.getElementById('ajouter-tache');

        // 1. Créez une fonction pour ajouter une nouvelle tâche
        function ajouterTache() {
            // Créez un nouvel élément <li>
            const nouvelleTache = document.createElement("li");
            // Ajoutez le <li> à la liste
            listeTaches.appendChild(nouvelleTache);
            // Ajoutez le texte de l'input comme contenu du <li>
            nouvelleTache.textContent = inputNouvelleTache.value;
            // Videz l'input après l'ajout
            inputNouvelleTache.value = "";
            // Ajout de l'écoute d'évenement pour la suppression au nouvel élément
            nouvelleTache.addEventListener("click", supprimerTache);
        }

        // 2. Ajoutez un écouteur d'événements au bouton pour appeler ajouterTache()
        boutonAjouter.addEventListener("click", ajouterTache);

        // 3. Créez une fonction pour supprimer une tâche lorsqu'on clique dessus
        function supprimerTache(event) {
            // Vérifiez si l'élément cliqué est un <li>
            if (event.target.nodeName === "LI") {
                // Si oui, supprimez-le de la liste
                listeTaches.removeChild(event.target);
            }
        }

        // 4. Ajoutez un écouteur d'événements à la liste pour gérer la suppression
        const elemListe = document.querySelectorAll("li");
        // on ajoute l'écouteur à tous les éléments déja dans la page ; pour ceux créés après il est ajouté à leur création par ajouterTache()
        elemListe.forEach(element => {
            element.addEventListener("click", supprimerTache);
        });

        // 4. alternatif : on applique l'écouteur sur le parent des li; quand on clique sur les li l'évenement "bubble" vers le parent -> c'est la qu'on le rattrape
        // le fait que l'ecouteur soit un niveau du parent nécéssite de tester le nodeName dans la fonction
        // avantage : ne nécéssite pas de devoir ajouter l'écouteur à chaque élément ET à chaque ajout
        listeTaches.addEventListener("click", supprimerTache);
    </script>
</head>

<body>
    <h1>Liste de tâches</h1>
    <ul id="liste-taches">
        <li>Tâche 1</li>
        <li>Tâche 2</li>
    </ul>
    <input type="text" id="nouvelle-tache" placeholder="Nouvelle tâche">
    <button id="ajouter-tache">Ajouter</button>
</body>

</html>